from datetime import datetime


class Joueur:
    def __init__(self, nom, prenom, date_naissance, matricule, points=0):
        self.nom = nom
        self.prenom = prenom
        self.date_naissance = date_naissance
        self.matricule = matricule
        self.points = points

    def ajouter_points(self, points):
        self.points += points  # Ajoute des points au total

    def __str__(self):
        return f"{self.prenom} {self.nom} - Points: {self.points}"

    @classmethod
    def from_dict(cls, data):
        return cls(
            nom=data['nom'],
            prenom=data['prenom'],
            date_naissance=datetime.strptime(data['date_naissance'], '%d/%m/%Y'),
            matricule=data['matricule'],
            points=data.get('points', 0)
        )

    def to_dict(self):
        return {
            'nom': self.nom,
            'prenom': self.prenom,
            'date_naissance': self.date_naissance.strftime('%d/%m/%Y'),
            'matricule': self.matricule,
            'points': self.points
        }

    @staticmethod
    def validate_matricule(matricule):
        return len(matricule) == 7 and matricule[:2].isalpha() and matricule[2:].isdigit()


class Match:
    def __init__(self, joueur1, joueur2, blanc=None, noir=None):
        self.joueur1 = joueur1
        self.joueur2 = joueur2
        self.resultat = None
        self.blanc = blanc if isinstance(blanc, Joueur) else joueur1  # Assurez-vous que blanc est un Joueur
        self.noir = noir if isinstance(noir, Joueur) else joueur2      # Assurez-vous que noir est un Joueur

    @classmethod
    def from_dict(cls, data):
        joueur1 = Joueur.from_dict(data['joueur1'])
        joueur2 = Joueur.from_dict(data['joueur2']) if data.get('joueur2') else None
        blanc = Joueur.from_dict(data['blanc']) if data.get('blanc') else joueur1
        noir = Joueur.from_dict(data['noir']) if data.get('noir') else joueur2
        match = cls(joueur1=joueur1, joueur2=joueur2, blanc=blanc, noir=noir)
        match.resultat = data.get('resultat')
        return match

    def to_dict(self):
        def safe_to_dict(obj):
            return obj.to_dict() if isinstance(obj, Joueur) else None

        return {
            'joueur1': self.joueur1.to_dict() if self.joueur1 else None,
            'joueur2': self.joueur2.to_dict() if self.joueur2 else None,
            'resultat': self.resultat,
            'blanc': safe_to_dict(self.blanc),
            'noir': safe_to_dict(self.noir)
        }


class Round:
    def __init__(self, nom, date_debut, date_fin, match_list=None):
        self.nom = nom
        self.date_debut = date_debut
        self.date_fin = date_fin
        self.match_list = match_list or []

    def ajouter_match(self, match):
        self.match_list.append(match)

    def to_dict(self):
        return {
            'nom': self.nom,
            'date_debut': self.date_debut.strftime('%d/%m/%Y %H:%M'),
            'date_fin': self.date_fin.strftime('%d/%m/%Y %H:%M'),
            'match_list': [match.to_dict() for match in self.match_list]
        }

    @classmethod
    def from_dict(cls, data):
        round_ = cls(
            nom=data['nom'],
            date_debut=datetime.strptime(data['date_debut'], '%d/%m/%Y %H:%M'),
            date_fin=datetime.strptime(data['date_fin'], '%d/%m/%Y %H:%M'),
            match_list=[Match.from_dict(m) for m in data['match_list']]
        )
        return round_


class Tournoi:
    def __init__(self, nom, lieu, date_debut, date_fin, rounds=4, numero_tour=0, rounds_list=None,
                 joueurs=None, description="", scores=None):
        self.nom = nom
        self.lieu = lieu
        self.date_debut = date_debut
        self.date_fin = date_fin
        self.rounds = rounds
        self.numero_tour = numero_tour
        self.rounds_list = rounds_list or []
        self.joueurs = joueurs or {}
        self.description = description
        self.scores = scores or {}
        self.rencontres = set()
        self.matchs = []

    def ajouter_round(self, tour_round):
        self.rounds_list.append(tour_round)

    def ajouter_joueur(self, joueur):
        if joueur.matricule in self.joueurs:
            raise ValueError(f"Le joueur avec le matricule {joueur.matricule} est déjà inscrit.")
        self.joueurs[joueur.matricule] = joueur
        self.scores[joueur.matricule] = joueur.points  # Initialise les scores avec les points du joueur

    def a_deja_joue(self, joueur1, joueur2):
        return ((joueur1.matricule, joueur2.matricule) in self.rencontres
                or (joueur2.matricule, joueur1.matricule) in self.rencontres)

    def ajouter_match(self, match):
        if match.joueur2 is not None:
            # Ajouter la rencontre entre les deux joueurs
            self.rencontres.add((match.joueur1.matricule, match.joueur2.matricule))
        self.matchs.append(match)

    def enregistrer_resultat(self, matricule, points):
        joueur = self.joueurs.get(matricule)
        if joueur:
            joueur.ajouter_points(points)  # Utiliser la méthode ajouter_points
        else:
            print(f"Joueur avec matricule {matricule} non trouvé.")

    @classmethod
    def from_dict(cls, data):
        tournoi = cls(
            nom=data['nom'],
            lieu=data['lieu'],
            date_debut=datetime.strptime(data['date_debut'], '%d/%m/%Y'),
            date_fin=datetime.strptime(data['date_fin'], '%d/%m/%Y'),
            rounds=data.get('nb_rounds', 4),  
            numero_tour=data.get('numero_tour', 0),
            rounds_list=[Round.from_dict(r) for r in data.get('rounds_list', [])],
            joueurs={matricule: Joueur.from_dict(j) for matricule, j in data.get('joueurs', {}).items()},
            description=data.get('description', ""),
            scores=data.get('scores', {})
        )
        return tournoi

    def to_dict(self):
        return {
            'nom': self.nom,
            'lieu': self.lieu,
            'date_debut': self.date_debut.strftime('%d/%m/%Y'),
            'date_fin': self.date_fin.strftime('%d/%m/%Y'),
            'rounds': self.rounds,
            'numero_tour': self.numero_tour,
            'rounds_list': [round.to_dict() for round in self.rounds_list],
            'joueurs': {matricule: joueur.to_dict() for matricule, joueur in self.joueurs.items()},
            'scores': self.scores,
            'description': self.description
        }
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       

























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       




















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       





















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       
























       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       


















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       



















       
















       































































































































































       
















       















       
















       














       
















       































































































































































       
















       















       
















       










